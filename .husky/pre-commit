#!/usr/bin/env sh

set -e
ROOT_DIR=$(git rev-parse --show-toplevel 2>/dev/null)
if command -v pnpm >/dev/null 2>&1 && [ -f "$ROOT_DIR/pnpm-lock.yaml" ]; then
  PKG_CMD=pnpm
else
  PKG_CMD=npm
fi

$PKG_CMD run typecheck
$PKG_CMD run validate:branch-name
$PKG_CMD run lint:staged:fix
$PKG_CMD run test:unit:staged
